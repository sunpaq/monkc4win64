
#if defined(__x86_64__)
asm(".text");
#if defined(__MACH__)
asm(".globl __push_jump");
asm(".p2align 4, 0x00");
asm("__push_jump:");
#else
asm(".globl __push_jump");
asm(".p2align 4, 0x00");
asm("__push_jump:");
#endif
asm("movq (%rcx), %r15"); //%rbp %rbx %r12-r15 belong to caller
asm("movq $0, (%rcx)");
asm("cmpq $0, %r15");
asm("je 0f");
asm("jmp *%r15");
asm("0:");
asm("ret");
#endif
